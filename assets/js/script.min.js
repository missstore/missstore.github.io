function wwm(s, f) {
	return new Promise(resolve => {
		if (document.querySelector(s)) return resolve(f);
		const observer = new MutationObserver(m => {
			if (document.querySelector(s)) {
				resolve(f);
				observer.disconnect();
			}
		});
		observer.observe(document, {
			childList: true,
			subtree: true
		});
	});
}

function AnimarHeader() {
	if (!document.querySelector(".carrinhoconteudo.aberto") && !document.querySelector(".categorias.aberto")) {
		let currentPostionY = scrollY;
		document.onscroll = function() {
			if (scrollY < currentPostionY) {
				currentPostionY = scrollY;
				document.querySelector(".header").style.removeProperty("transform");
			} else if (scrollY > currentPostionY) {
				currentPostionY = scrollY;
				document.querySelector(".header").style.transform = "translate(0, -40px)";
			}
		};
	}
}

function abrirFull(foto) {
	document.onscroll = null;
	document.body.style.overflow = "hidden";
	document.querySelector(".verfotofull").classList.add("carregando");
	history.state ?
		(
			history.back(),
			setTimeout(function() {
				wwm(".verfotofull.carregando").then(function() {
					window.history.pushState('forward', 'foto', '#');
					document.querySelector(".fotofullviewing").querySelector("img").src = foto;
					document.querySelector(".fotofullviewing").classList.add("aberto");
				})
			}, 100)
		) :
		(
			wwm(".verfotofull.carregando").then(function() {
				window.history.pushState('forward', 'foto', '#');
				document.querySelector(".fotofullviewing").querySelector("img").src = foto;
				document.querySelector(".fotofullviewing").classList.add("aberto");
			})
		);
		document.querySelector(".fotofullviewing").querySelector("img").onload=function(){
			document.querySelector(".verfotofull").classList.remove("carregando");
		};
}

function RequestImagens(path, mutiplos) {
	let imagestoload = [];
	mutiplos = mutiplos || false;

	function criarImages(caminho) {
		let req = new XMLHttpRequest();
		req.open("GET", "https://missstore.github.io/assets/img" + caminho + "info.txt", true);
		req.onload = function() {
			JSON.parse(req.response).info.forEach(function(e) {
				let divProdutoInteiro = document.createElement("div");
				divProdutoInteiro.classList.add("produtodiv");
				let novaImg = document.createElement("div");
				novaImg.classList.add("produtoimagen");
				novaImg.style.backgroundImage = 'url("https://missstore.github.io/assets/img' + caminho + e.src + '")';
				novaImg.style.width = "100%";
				novaImg.style.height = "100%";
				novaImg.style.backgroundRepeat = "no-repeat";
				novaImg.style.backgroundPosition = "center,center";
				novaImg.style.backgroundSize = "cover";
				novaImg.style.borderRadius = "5px";
				novaImg.addEventListener("click", function() {
					let urlImagem = this.style.backgroundImage.substring(5, this.style.backgroundImage.length - 2);
					abrirFull(urlImagem);
				});
				divProdutoInteiro.append(novaImg);
				let divTofull = document.createElement("div");
				divTofull.classList.add("fullimage");
				let ClickToFull = document.createElement("i");
				ClickToFull.setAttribute("class", "fas fa-search-plus");
				divTofull.append(ClickToFull);
				ClickToFull.addEventListener("click", function() {
					let BgI = this.parentElement.parentElement.querySelector(".produtoimagen").style.backgroundImage;
					let urlImagem = BgI.substring(5, BgI.length - 2);
					abrirFull(urlImagem);
				});
				divProdutoInteiro.append(divTofull);
				let NomeProduto = document.createElement("div");
				NomeProduto.classList.add("produtonome");
				NomeProduto.textContent = e.nome;
				divProdutoInteiro.append(NomeProduto);
				let ValorProduto = document.createElement("div");
				ValorProduto.classList.add("produtovalor");
				ValorProduto.textContent = "R$" + e.valor;
				divProdutoInteiro.append(ValorProduto);
				let BtnAdicionar = document.createElement("div");
				BtnAdicionar.classList.add("produtoadicionar");
				BtnAdicionar.textContent = "+CARRINHO";
				BtnAdicionar.addEventListener("click", function() {
					let s = this.parentElement.querySelector(".produtoimagen").style.backgroundImage;
					s = s.substring(5, s.length - 2);
					let n = this.parentElement.querySelector(".produtonome").textContent;
					let v = this.parentElement.querySelector(".produtovalor").textContent;
					if (verificarsejatem(this.parentElement.querySelector(".produtonome").textContent)) {
						let oQue = this.parentElement.querySelector(".produtonome").textContent;
						document.querySelector(".adicionados").querySelectorAll(".informacoesdoadicionado .nomedoproduto").forEach(function(e) {
							if (e.textContent == oQue) {
								e.parentElement.querySelector(".quantidadeacomprar").value = Number(e.parentElement.querySelector(".quantidadeacomprar").value) + 1;
								adicionardadosnostorage(n, s, n, v, e.parentElement.querySelector(".quantidadeacomprar").value);
							}
						});
						notificarsucess();
						fazersoma();
					} else {
						let divConteudoAdicionado = document.createElement("div");
						divConteudoAdicionado.classList.add("conteudoadicionado");
						let divDaimagem = document.createElement("div");
						divDaimagem.classList.add("imgcontainer");
						let imgConteudoAdicionado = document.createElement("img");
						let srcValor = this.parentElement.querySelector(".produtoimagen").style.backgroundImage;
						imgConteudoAdicionado.width = 72;
						imgConteudoAdicionado.src = srcValor.substring(5, srcValor.length - 2);
						imgConteudoAdicionado.classList.add("imagemdoproduto");
						imgConteudoAdicionado.addEventListener("click", function() {
							abrirFull(this.src);
						});
						divDaimagem.append(imgConteudoAdicionado);
						divConteudoAdicionado.append(divDaimagem);
						let infoDoAdicionado = document.createElement("div");
						infoDoAdicionado.classList.add("informacoesdoadicionado");
						let nomeDoConteudo = document.createElement("label");
						nomeDoConteudo.classList.add("nomedoproduto");
						nomeDoConteudo.textContent = this.parentElement.querySelector(".produtonome").textContent;
						infoDoAdicionado.append(nomeDoConteudo);
						let quantidadeComprando = document.createElement("input");
						quantidadeComprando.classList.add("quantidadeacomprar");
						quantidadeComprando.value = 1;
						quantidadeComprando.type = "number";
						quantidadeComprando.addEventListener("change", function() {
							let divinicio = this.parentElement.parentElement;
							let s = divinicio.querySelector(".imgcontainer img").src;
							let n = divinicio.querySelector(".nomedoproduto").textContent;
							let v = divinicio.querySelector(".valordoproduto").textContent;
							let q = divinicio.querySelector(".quantidadeacomprar").value;
							let nomedoproduto = this.parentElement.querySelector(".nomedoproduto").textContent;
							if (this.value == 0 || this.value == '') {
								let con = confirm("Deseja remover este item do carrinho?\n" + nomedoproduto);
								con == true ? (
										this.parentElement.parentElement.remove(),
										removerdostorage(n),
										fazersoma()
									) :
									(this.value = 1, fazersoma(), adicionardadosnostorage(n, s, n, v, 1));
							} else {
								fazersoma();
								adicionardadosnostorage(n, s, n, v, q);
							}
						});
						quantidadeComprando.addEventListener("keyup", function() {
							fazersoma();
						});
						quantidadeComprando.addEventListener("keydown", function() {
							fazersoma();
						});
						infoDoAdicionado.append(quantidadeComprando);
						divConteudoAdicionado.append(infoDoAdicionado);
						let ApagarConteudoEvalor = document.createElement("div");
						ApagarConteudoEvalor.classList.add("valoretrash");
						let IconeTrash = document.createElement("i");
						IconeTrash.setAttribute("class", "fas fa-trash-alt");
						IconeTrash.addEventListener("click", function() {
							let nomedoproduto = this.parentElement.parentElement.querySelector(".informacoesdoadicionado .nomedoproduto").textContent;
							let con = confirm("Tem certeza que deseja remover este item do carrinho?\n" + nomedoproduto);
							con == true ?
								(this.parentElement.parentElement.remove(),
									removerdostorage(nomedoproduto),
									fazersoma()) :
								null;
						});
						ApagarConteudoEvalor.append(IconeTrash);
						let ValorDoConteudo = document.createElement("span");
						ValorDoConteudo.classList.add("valordoproduto");
						ValorDoConteudo.textContent = this.parentElement.querySelector(".produtovalor").textContent;
						ApagarConteudoEvalor.append(ValorDoConteudo);
						divConteudoAdicionado.append(ApagarConteudoEvalor);
						document.querySelector(".adicionados").appendChild(divConteudoAdicionado);
						fazersoma();
						notificarsucess();
						adicionardadosnostorage(n, s, n, v, 1);
					}
				});
				divProdutoInteiro.append(BtnAdicionar);
				let BtnComprar = document.createElement("div");
				BtnComprar.classList.add("produtocomprar");
				BtnComprar.textContent = "COMPRAR";
				BtnComprar.addEventListener("click", function() {
					let imagem = this.parentElement.querySelector(".produtoimagen").style.backgroundImage;
					imagem = imagem.substring(5, imagem.length - 2);
					let texto = 'Olá!%0aGostaria de fazer uma compra%0a';
					texto += '%0aFoto do produto: ' + imagem;
					texto += '%0aNome do produto: ' + this.parentElement.querySelector(".produtonome").textContent;
					texto += '%0aValor do produto: ' + this.parentElement.querySelector(".produtovalor").textContent;
					window.open("https://wa.me/5569992841780?text=" + texto);
				});
				divProdutoInteiro.append(BtnComprar);
				document.querySelector(".produtos .loadercontainer").appendChild(divProdutoInteiro);
				let url = novaImg.style.backgroundImage.substring(5, novaImg.style.backgroundImage.length - 2),
					img = new Image();
				img.src = url;
				imagestoload.push(img.src);
				img.onload = function() {
					let oIndex = imagestoload.findIndex(f => f.includes(img.src));
					imagestoload.length <= 1 ?
						(
							document.querySelector(".loadercontainer").classList.remove("carregando"), obterdadosdostorage()
						) :
						imagestoload.splice(oIndex, 1);
				};
			});
		};
		req.send();
	}
	if (mutiplos == true) {
		document.querySelector(".nome").textContent = "TODOS OS PRODUTOS";
		let no = path.split(",");
		for (let i = 0; i < no.length; i++) {
			new criarImages(no[i]);
		}
	} else {
		let nome = path == "/calcas/" ? "Calças/" : path;
		document.querySelector(".nome").textContent = nome.replaceAll("/", "").toUpperCase();
		criarImages(path);
	}
}

function VerMouseDownCategorias(elmselec) {
	document.onmousedown = function(e) {
		if (e.target.className) {
			if (e.target.className != "catCont" && e.target.className != "far fa-images" && e.target.className != "fas fa-list" && e.target.className != "contentsCategorias") {
				document.querySelector(".categorias").classList.remove("aberto");
				document.body.style.overflow = "visible";
				AnimarHeader();
				document.onmousedown = null;
				document.querySelector(".fa-list").classList.remove("selecionado");
				elmselec.classList.add("selecionado");
			}
		} else {
			if (e.target.textContent != "PRODUTOS" && e.target.textContent != "Croppeds" &&
				e.target.textContent != "Calças" && e.target.textContent != "Vestidos" && e.target.textContent != "Saias" && e.target.textContent != "Conjuntos") {
				document.querySelector(".categorias").classList.remove("aberto");
				document.body.style.overflow = "visible";
				AnimarHeader();
				document.onmousedown = null;
				document.querySelector(".fa-list").classList.remove("selecionado");
				elmselec.classList.add("selecionado");
			}
		}
	};
}

function notificarsucess() {
	function apagar(id) {
		setTimeout(function() {
			document.getElementById(id) ? document.getElementById(id).remove() : null;
		}, 1500);
	}

	function makeid(length) {
		var result = '';
		var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
		var charactersLength = characters.length;
		for (var i = 0; i < length; i++) {
			result += characters.charAt(Math.floor(Math.random() *
				charactersLength));
		}
		return result;
	}
	document.querySelector(".bodysucesso") ? document.querySelector(".bodysucesso").remove() : null;
	let ID = makeid(10);
	let cridiv = document.createElement("div");
	document.body.appendChild(cridiv);
	cridiv.outerHTML = `
<div class="bodysucesso" id="` + ID + `">
<div class="sucessoadicionado">
<div class="success-checkmark">
  <div class="check-icon">
    <span class="icon-line line-tip"></span>
    <span class="icon-line line-long"></span>
    <div class="icon-circle"></div>
    <div class="icon-fix"></div>
  </div>
</div>
    <label>Item adicionado com sucesso!</label>
</div>
</div>
`;
	new apagar(ID);
}

function fazersoma() {
	if (document.querySelectorAll(".adicionados .valordoproduto").length > 0) {
		let soma = [];
		document.querySelector(".contagem span").textContent = 0;
		document.querySelectorAll(".adicionados .valordoproduto").forEach(function(i) {
			soma.push(i.textContent.replace("R$", "").replace(",", ".") * i.parentElement.parentElement.querySelector("input").value);
			document.querySelector(".contagem span").textContent = Number(document.querySelector(".contagem span").textContent) + Number(i.parentElement.parentElement.querySelector("input").value);
		});
		document.querySelector(".contagem").classList.add("itens");
		let valortotaldasoma = eval(soma.toString().replaceAll(",", "+")).toString().substring(0,eval(soma.toString().replaceAll(",", "+")).toString());
		if (valortotaldasoma.toString().includes(".")) {
			if (valortotaldasoma.toString().split(".")[1].length > 2) {
				valortotaldasoma = eval(valortotaldasoma.toString().split(".")[0] + "." + valortotaldasoma.toString().split(".")[1].substring(0, 2) + "+.011");
				valortotaldasoma = valortotaldasoma.toString().split(".")[0] + "," + valortotaldasoma.toString().split(".")[1].substring(0, 1);
				document.querySelector(".valortotal").textContent = "Valor total: R$" + valortotaldasoma.toString().replace(".", ",") + "0";
			} else {
				document.querySelector(".valortotal").textContent = "Valor total: R$" + valortotaldasoma.replace(".", ",") + "0";
			}
		} else {
			if (valortotaldasoma) {
				document.querySelector(".valortotal").textContent = "Valor total: R$" + valortotaldasoma.replace(".", ",") + ",00";
			} else {
				document.querySelector(".valortotal").textContent = "";
			}
		}
		if(document.querySelector(".valortotal").textContent != ""){
			let ValorFinal = document.querySelector(".enviarevalortotal > label").textContent;
			let ValorFormatado = ValorFinal.substring(ValorFinal.indexOf("R$")+2,ValorFinal.length);
			let PI = ValorFormatado.split(",")[0];
			let SI = ValorFormatado.split(",")[1];
			let res1 = PI.length/2==2?PI.substring(0,PI.length/2-1):PI.substring(0,PI.length/2);
			let res2 = PI.length/2==2?PI.substring(PI.length/2-1,PI.length):PI.substring(PI.length/2,PI.length);
			let totalformatado = res2.length>=3?res1+"."+res2+","+SI:res1+res2+","+SI;
			document.querySelector(".valortotal").textContent = "Valor total: R$" + totalformatado;
		}
	} else {
		document.querySelector(".valortotal").textContent = '';
		document.querySelector(".contagem").classList.remove("itens");
	}
}

function abrirlink(from) {
	if (from == "whatsapp") {
		window.open("https://wa.me/5569992841780");
	} else if (from == "instagram") {
		window.open("https://instagram.com/miss.store.pvh")
			/* window.location.assign(window.location.protocol + "//" + "instagram://user?username=miss.store.pvh") */
		/* window.location = "instagram://user?username=miss.store.pvh" */
	} else if (from == "facebook") {
		window.open("https://www.facebook.com/106313655191627")
		/* fb://facewebmodal/f?href=FACEBOOKURL  ||  fb://profile/ */
		/* window.location = "fb://page/106313655191627/" */
		/* window.location.assign(window.location.protocol + "//" + "fb://page/106313655191627/") */
	}
}

function adicionardadosnostorage(i, s, n, v, q) {
	let content = '{"item":[{' +
		'"nome":' + '"' + n + '",' +
		'"src":' + '"' + s + '",' +
		'"valor":' + '"' + v + '",' +
		'"quantidade":' + '"' + q + '"' + "}]" + "}"
	localStorage.setItem("carrinho_missstore_" + i, content)
}

function removerdostorage(nome) {
	for (let i = 0; i < localStorage.length; i++) {
		if (localStorage.key(i) == "carrinho_missstore_" + nome) {
			localStorage.removeItem(localStorage.key(i))
		}
	}
}

function removerdostoragetodos() {
	for (let i = 0; i < localStorage.length; i++) {
		if (localStorage.key(i).includes("carrinho_missstore_")) {
			localStorage.removeItem(localStorage.key(i))
			new removerdostoragetodos();
		}
	}
}

function verificarsejatem(nome) {
	let temp = [];
	document.querySelector(".adicionados").querySelectorAll(".informacoesdoadicionado .nomedoproduto").forEach(function(e) {
		e.textContent == nome ? temp.push(e.textContent) : null;
	})
	if (temp.length > 0) {
		return true;
	} else {
		return false;
	}
}

function obterdadosdostorage() {
	for (let i = 0; i < localStorage.length; i++) {
		if (localStorage.key(i).includes("carrinho_missstore_")) {
			let result = JSON.parse(localStorage.getItem(localStorage.key(i))).item;
			if (result[0]) {
				let req = new XMLHttpRequest();
				req.open("GET", result[0].src, true)
				req.send();
				req.onload = function() {
					if (req.response.includes("Página não encontrada")) {
						removerdostorage(result[0].nome);
					} else {
						if (verificarsejatem(result[0].nome)) {
							let oQue = result[0].nome;
							document.querySelector(".adicionados").querySelectorAll(".informacoesdoadicionado .nomedoproduto").forEach(function(e) {
								if (e.textContent == oQue) {
									e.parentElement.querySelector(".quantidadeacomprar").value = Number(e.parentElement.querySelector(".quantidadeacomprar").value) + 1;
									adicionardadosnostorage(n, s, n, v, e.parentElement.querySelector(".quantidadeacomprar").value);
								}
							});
							fazersoma();
						} else {
							let divConteudoAdicionado = document.createElement("div");
							divConteudoAdicionado.classList.add("conteudoadicionado");
							let divDaimagem = document.createElement("div");
							divDaimagem.classList.add("imgcontainer");
							let imgConteudoAdicionado = document.createElement("img");
							imgConteudoAdicionado.width = 72;
							imgConteudoAdicionado.src = result[0].src;
							imgConteudoAdicionado.classList.add("imagemdoproduto");
							imgConteudoAdicionado.addEventListener("click", function() {
								abrirFull(this.src);
							});
							divDaimagem.append(imgConteudoAdicionado);
							divConteudoAdicionado.append(divDaimagem);
							let infoDoAdicionado = document.createElement("div");
							infoDoAdicionado.classList.add("informacoesdoadicionado");
							let nomeDoConteudo = document.createElement("label");
							nomeDoConteudo.classList.add("nomedoproduto");
							nomeDoConteudo.textContent = result[0].nome;
							infoDoAdicionado.append(nomeDoConteudo);
							let quantidadeComprando = document.createElement("input");
							quantidadeComprando.classList.add("quantidadeacomprar");
							quantidadeComprando.value = result[0].quantidade;
							quantidadeComprando.type = "number";
							quantidadeComprando.addEventListener("change", function() {
								let divinicio = this.parentElement.parentElement;
								let s = divinicio.querySelector(".imgcontainer img").src;
								let n = divinicio.querySelector(".nomedoproduto").textContent;
								let v = divinicio.querySelector(".valordoproduto").textContent;
								let q = divinicio.querySelector(".quantidadeacomprar").value;
								let nomedoproduto = this.parentElement.querySelector(".nomedoproduto").textContent;
								if (this.value == 0 || this.value == '') {
									let con = confirm("Deseja remover este item do carrinho?\n" + nomedoproduto);
									con == true ? (
											this.parentElement.parentElement.remove(),
											removerdostorage(n),
											fazersoma()
										) :
										(this.value = 1, fazersoma(), adicionardadosnostorage(n, s, n, v, 1));
								} else {
									fazersoma();
									adicionardadosnostorage(n, s, n, v, q);
								}
							});
							quantidadeComprando.addEventListener("keyup", function() {
								fazersoma();
							});
							quantidadeComprando.addEventListener("keydown", function() {
								fazersoma();
							});
							infoDoAdicionado.append(quantidadeComprando);
							divConteudoAdicionado.append(infoDoAdicionado);
							let ApagarConteudoEvalor = document.createElement("div");
							ApagarConteudoEvalor.classList.add("valoretrash");
							let IconeTrash = document.createElement("i");
							IconeTrash.setAttribute("class", "fas fa-trash-alt");
							IconeTrash.addEventListener("click", function() {
								let nomedoproduto = this.parentElement.parentElement.querySelector(".informacoesdoadicionado .nomedoproduto").textContent;
								let con = confirm("Tem certeza que deseja remover este item do carrinho?\n" + nomedoproduto);
								con == true ?
									(this.parentElement.parentElement.remove(),
										removerdostorage(nomedoproduto),
										fazersoma()) :
									null;
							});
							ApagarConteudoEvalor.append(IconeTrash);
							let ValorDoConteudo = document.createElement("span");
							ValorDoConteudo.classList.add("valordoproduto");
							ValorDoConteudo.textContent = result[0].valor;
							ApagarConteudoEvalor.append(ValorDoConteudo);
							divConteudoAdicionado.append(ApagarConteudoEvalor);
							document.querySelector(".adicionados").appendChild(divConteudoAdicionado);
							fazersoma();
						}
					}
				};
			}

		}
		i == localStorage.length - 1 ? fazersoma() : null;
	}
}

String.prototype.shuffle = function() {
	var a = this.split(","),
	n = a.length;
	for (var i = n - 1; i > 0; i--) {
		var j = Math.floor(Math.random() * (i + 1));
		var tmp = a[i];
		a[i] = a[j];
		a[j] = tmp;
	}
	return a.join(",");
}
	
let selec;	
wwm(".selecionado").then(function() {
	selec = document.querySelector(".selecionado");
});
wwm(".fas.fa-home").then(function() {
	document.querySelector(".fas.fa-home").addEventListener("click", function() {
		document.querySelector(".produtos").outerHTML='\
		<div class="produtos">\
			<div class="loadercontainer carregando">\
				<label>Carregando Imagens</label>\
				<div class="loader"></div>\
			</div>\
		</div>'
		window.location.assign("/");
	});
});
wwm(".fas.fa-eraser").then(function() {
	document.querySelector(".fas.fa-eraser").addEventListener("click", function() {
		if (document.querySelector(".adicionados").childElementCount > 0) {
			let con = confirm("Tens certeza que deseja esvaziar o carrinho?");
			con == true ?
			(
				document.querySelector(".adicionados").outerHTML='<div class="adicionados"></div>',
				document.querySelector(".valortotal").textContent = "",
				removerdostoragetodos(),
				fazersoma()
			)
			:null;
		} else {
			let ultimotexto = document.querySelector(".valortotal").textContent;
			document.querySelector(".valortotal").textContent = "Nenhum item no carrinho.";
			let chamaratencao = setInterval(function() {
				if (!document.querySelector(".valortotal").style.color) {
					document.querySelector(".valortotal").style.color = "red";
				} else {
					if (document.querySelector(".valortotal").style.color == "red") {
						document.querySelector(".valortotal").style.color = "rgb(23, 32, 42)";
					} else if (document.querySelector(".valortotal").style.color == "rgb(23, 32, 42)") {
						document.querySelector(".valortotal").style.color = "red";
					}
				}
			}, 100);
			setTimeout(function() {
				document.querySelector(".valortotal").removeAttribute("style");
				if(document.querySelector(".valortotal").textContent=="Nenhum item no carrinho."){
					document.querySelector(".valortotal").textContent = ultimotexto;
				}
				clearInterval(chamaratencao)
			}, 2000);
		}
	});
});
wwm(".far.fa-images").then(function() {
	document.querySelectorAll(".far.fa-images").forEach(function(e) {
		e.addEventListener("click", function() {
			let nome = this.children[0].textContent.toLowerCase();
			nome.includes("ç") ? nome = nome.replace("ç", "c") : null;
			window.location.assign("/" + nome);
		});
	});
});
wwm(".entreemcontato").then(function() {
	document.querySelector(".entreemcontato").querySelectorAll("i").forEach(function(e) {
		let deonde = e.children[0].textContent.toLowerCase();
		e.addEventListener("click", function() {
			abrirlink(deonde);
		});
	});
});
wwm(".header").then(function() {
	AnimarHeader();
});
wwm(".fa-paper-plane").then(function() {
	document.querySelector(".fa-paper-plane").addEventListener("click", function() {
		if (document.querySelector(".adicionados").childElementCount > 0) {
			let texto = 'Olá!%0aGostaria de fazer uma compra%0a';
			let _i = document.querySelectorAll(".conteudoadicionado").length - 1;
			document.querySelectorAll(".conteudoadicionado").forEach(function(e, i) {
				texto += ' %0aFoto do produto: ' + e.querySelector(".imgcontainer img").src;
				texto += ' %0aNome do produto: ' + e.querySelector(".informacoesdoadicionado .nomedoproduto").textContent;
				texto += ' %0aValor do produto: ' + e.querySelector(".valoretrash .valordoproduto").textContent;
				texto += ' %0aQuantidade: ' + e.querySelector(".informacoesdoadicionado .quantidadeacomprar").value;
				i != _i ? texto += ' %0a--------------------//--------------------' :
					texto += ' %0a--------------------//--------------------%0a' + 
					document.querySelector(".valortotal").textContent + 
					"%0a*Valor total à confirmar devido alterações constantes*";
			});
			window.open("https://wa.me/5569992841780?text=" + texto);
		} else {
			let ultimotexto = document.querySelector(".valortotal").textContent;
			document.querySelector(".valortotal").textContent = "Nenhum item no carrinho.";
			let chamaratencao = setInterval(function() {
				if (!document.querySelector(".valortotal").style.color) {
					document.querySelector(".valortotal").style.color = "red";
				} else {
					if (document.querySelector(".valortotal").style.color == "red") {
						document.querySelector(".valortotal").style.color = "rgb(23, 32, 42)";
					} else if (document.querySelector(".valortotal").style.color == "rgb(23, 32, 42)") {
						document.querySelector(".valortotal").style.color = "red";
					}
				}
			}, 100);
			setTimeout(function() {
				document.querySelector(".valortotal").removeAttribute("style");
				if(document.querySelector(".valortotal").textContent=="Nenhum item no carrinho."){
					document.querySelector(".valortotal").textContent = ultimotexto;
				}
				clearInterval(chamaratencao)
			}, 2000);
		}
	});
});
wwm(".produtos .loadercontainer").then(function() {
	if (window.location.pathname == "/") {
		RequestImagens("/croppeds/,/saias/,/vestidos/,/calcas/,/conjuntos/".shuffle(), true);
	} else {
		RequestImagens(window.location.pathname + "/");
	}
});
wwm(".fotofullviewing .fa-window-close").then(function() {
	document.querySelector(".fotofullviewing .fa-window-close").addEventListener("click", function() {
		if (!document.querySelector(".carrinhoconteudo.aberto")) {
			AnimarHeader();
			document.body.style.overflow = "visible";
		}
		history.state ? history.back() : null;
		this.parentElement.classList.remove("aberto");
		document.querySelector(".fotofullviewing img").src = '';
	});
});
wwm(".fa-shopping-cart").then(function() {
	document.querySelector(".fa-shopping-cart").addEventListener("click", function() {
		document.querySelector(".carrinhoconteudo").classList.add("aberto");
		document.onscroll = null;
		document.body.style.overflow = "hidden";
	});
});
wwm(".fa-chevron-circle-left").then(function() {
	document.querySelector(".fa-chevron-circle-left").addEventListener("click", function() {
		document.querySelector(".carrinhoconteudo").classList.remove("aberto");
		AnimarHeader();
		document.body.style.overflow = "visible";
	});
});
wwm(".fa-list").then(function() {
	document.querySelector(".fa-list").addEventListener("click", function() {
		if (document.querySelector(".categorias.aberto")) {
			document.querySelector(".categorias").classList.remove("aberto");
			document.onmousedown = null;
			AnimarHeader();
			document.body.style.overflow = "visible";
			document.querySelector(".fa-list").classList.remove("selecionado");
			selec.classList.add("selecionado");
		} else {
			document.querySelector(".categorias").classList.add("aberto");
			selec.classList.remove("selecionado");
			document.querySelector(".fa-list").classList.add("selecionado");
			document.body.style.overflow = "hidden";
			VerMouseDownCategorias(selec);
		}
	});
});
window.addEventListener('popstate', function() {
	if (!document.querySelector(".carrinhoconteudo.aberto")) {
		AnimarHeader();
		document.body.style.overflow = "visible";
	}
	document.querySelector(".fotofullviewing img").src = '';
	document.querySelector(".fotofullviewing").classList.remove("aberto");
});